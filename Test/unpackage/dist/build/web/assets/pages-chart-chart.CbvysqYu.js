import{r as e,f as a,g as t,h as s,c as l,w as o,j as r,i,o as n,a as c,b as u,t as d,d as v}from"./index-CZErqaCe.js";import{_ as m}from"./_plugin-vue_export-helper.BCo6x5W8.js";const p=m({__name:"chart",setup(m){const p=a(!0),f=a(""),h=a(null),g=a("用户使用统计");let y=null;const _=async()=>{try{p.value=!0,f.value="";const a=await((a,t={})=>new Promise(((s,l)=>{e({url:""+a,method:t.method||"GET",data:t.data||{},header:{"Content-Type":"application/json",...t.header},success:e=>{var a;200===e.statusCode?s(e.data):l(new Error(`请求失败: ${e.statusCode} - ${(null==(a=e.data)?void 0:a.message)||e.errMsg||"未知错误"}`))},fail:e=>{console.error("请求失败:",e),l(new Error(e.errMsg||"网络请求失败，请检查网络连接和后端服务"))}})})))("/api/dashboard/getUserFrequency");if(200===a.code){if(h.value=a.data,console.log("图表数据:",h.value),!h.value||!h.value.categories||0===h.value.categories.length)return f.value="数据为空，请检查后端数据",void(g.value="暂无数据");const e=h.value.categories?h.value.categories.length:0;g.value=e>0?`显示${e}个数据点`:"用户使用统计",await r(),setTimeout((()=>{w()}),100)}else f.value=a.message||"获取数据失败"}catch(a){f.value="网络请求失败: "+(a.message||"请检查后端服务是否启动"),console.error("请求错误:",a)}finally{p.value=!1}},w=()=>{if("undefined"==typeof echarts)return console.error("ECharts未加载，请检查CDN"),void(f.value="图表库加载失败");const e=document.getElementById("chart");if(!e)return console.error("找不到图表容器"),void setTimeout((()=>{w()}),200);y=echarts.init(e),b();const a=()=>{null==y||y.resize()};window.addEventListener("resize",a),y._resizeHandler=a},b=()=>{if(!h.value||!y)return;const e={tooltip:{trigger:"axis",axisPointer:{type:"line"}},grid:{left:"10%",right:"5%",bottom:"15%",top:"5%",height:"auto"},xAxis:{type:"category",data:h.value.categories||[],axisLabel:{rotate:0,fontSize:11},name:"日期",nameLocation:"middle",nameGap:30},yAxis:{type:"value",name:"使用次数",nameLocation:"middle",nameGap:50,axisLabel:{fontSize:11,showMinLabel:!0,showMaxLabel:!0},minInterval:1,splitNumber:5,splitLine:{show:!0,lineStyle:{color:"#e5e5e5",type:"dashed"},interval:0}},series:[{name:"使用次数",type:"line",smooth:!0,data:h.value.values||[],itemStyle:{color:"#007AFF"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(0, 122, 255, 0.3)"},{offset:1,color:"rgba(0, 122, 255, 0.05)"}]}},lineStyle:{width:3},symbol:"circle",symbolSize:8,label:{show:!0,position:"top",fontSize:10}}]};y.setOption(e)};return t((()=>{_()})),s((()=>{y&&(y._resizeHandler&&window.removeEventListener("resize",y._resizeHandler),y.dispose(),y=null)})),(e,a)=>{const t=v,s=i;return n(),l(s,{class:"container"},{default:o((()=>[c(s,{class:"header"},{default:o((()=>[c(t,{class:"title"},{default:o((()=>[u("用户使用频率统计")])),_:1}),c(t,{class:"subtitle"},{default:o((()=>[u(d(g.value),1)])),_:1})])),_:1}),c(s,{class:"chart-container"},{default:o((()=>[p.value?(n(),l(s,{key:0,class:"loading"},{default:o((()=>[u("加载中...")])),_:1})):f.value?(n(),l(s,{key:1,class:"error"},{default:o((()=>[u(d(f.value),1)])),_:1})):(n(),l(s,{key:2,class:"chart-wrapper"},{default:o((()=>[c(s,{id:"chart",class:"chart"})])),_:1}))])),_:1})])),_:1})}}},[["__scopeId","data-v-eef0c984"]]);export{p as default};
